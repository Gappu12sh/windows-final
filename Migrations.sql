DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Customer.Data.Application.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF object_id('[app].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [app].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Customer.Data.Application.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '202306121239292_createNewEntity'
BEGIN
    IF schema_id('app') IS NULL
        EXECUTE('CREATE SCHEMA [app]')
    CREATE TABLE [app].[DepartmentMaster] (
        [Department_ID] [int] NOT NULL IDENTITY,
        [Department_Name] [nvarchar](max),
        [IsActive] [bit] NOT NULL,
        [Department_Created_By] [int],
        [Department_Updated_By] [int],
        [Department_DOE] [datetime],
        [Department_DOU] [datetime],
        CONSTRAINT [PK_app.DepartmentMaster] PRIMARY KEY ([Department_ID])
    )
    CREATE INDEX [IX_Department_Created_By] ON [app].[DepartmentMaster]([Department_Created_By])
    CREATE INDEX [IX_Department_Updated_By] ON [app].[DepartmentMaster]([Department_Updated_By])
    CREATE TABLE [app].[UserDetails] (
        [UserID] [int] NOT NULL IDENTITY,
        [UserName] [nvarchar](max),
        [User_Email] [nvarchar](max),
        [User_Password] [nvarchar](max),
        [User_Created_By] [int],
        [IsActive] [bit] NOT NULL,
        [User_DOE] [datetime],
        [User_Updated_By] [int],
        [User_DOU] [datetime],
        [User_Type] [nvarchar](max),
        [Rep_ID] [int],
        CONSTRAINT [PK_app.UserDetails] PRIMARY KEY ([UserID])
    )
    CREATE INDEX [IX_User_Created_By] ON [app].[UserDetails]([User_Created_By])
    CREATE INDEX [IX_User_Updated_By] ON [app].[UserDetails]([User_Updated_By])
    CREATE INDEX [IX_Rep_ID] ON [app].[UserDetails]([Rep_ID])
    CREATE TABLE [app].[Representatives] (
        [Rep_ID] [int] NOT NULL IDENTITY,
        [Rep_Unique_ID] [int] NOT NULL,
        [Rep_Name] [nvarchar](max),
        [IsActive] [bit] NOT NULL,
        [Rep_Created_By] [int],
        [Rep_Updated_By] [int],
        [Rep_DOE] [datetime],
        [Rep_DOU] [datetime],
        CONSTRAINT [PK_app.Representatives] PRIMARY KEY ([Rep_ID])
    )
    CREATE INDEX [IX_Rep_Created_By] ON [app].[Representatives]([Rep_Created_By])
    CREATE INDEX [IX_Rep_Updated_By] ON [app].[Representatives]([Rep_Updated_By])
    CREATE TABLE [app].[LogInSession] (
        [LoginSessionId] [int] NOT NULL IDENTITY,
        [LoginToken] [nvarchar](max) NOT NULL,
        [LoginUserId] [int] NOT NULL,
        [SessionTimeStamp] [datetime] NOT NULL,
        CONSTRAINT [PK_app.LogInSession] PRIMARY KEY ([LoginSessionId])
    )
    CREATE INDEX [IX_LoginUserId] ON [app].[LogInSession]([LoginUserId])
    ALTER TABLE [app].[DepartmentMaster] ADD CONSTRAINT [FK_app.DepartmentMaster_app.UserDetails_Department_Created_By] FOREIGN KEY ([Department_Created_By]) REFERENCES [app].[UserDetails] ([UserID])
    ALTER TABLE [app].[DepartmentMaster] ADD CONSTRAINT [FK_app.DepartmentMaster_app.UserDetails_Department_Updated_By] FOREIGN KEY ([Department_Updated_By]) REFERENCES [app].[UserDetails] ([UserID])
    ALTER TABLE [app].[UserDetails] ADD CONSTRAINT [FK_app.UserDetails_app.Representatives_Rep_ID] FOREIGN KEY ([Rep_ID]) REFERENCES [app].[Representatives] ([Rep_ID])
    ALTER TABLE [app].[UserDetails] ADD CONSTRAINT [FK_app.UserDetails_app.UserDetails_User_Created_By] FOREIGN KEY ([User_Created_By]) REFERENCES [app].[UserDetails] ([UserID])
    ALTER TABLE [app].[UserDetails] ADD CONSTRAINT [FK_app.UserDetails_app.UserDetails_User_Updated_By] FOREIGN KEY ([User_Updated_By]) REFERENCES [app].[UserDetails] ([UserID])
    ALTER TABLE [app].[Representatives] ADD CONSTRAINT [FK_app.Representatives_app.UserDetails_Rep_Created_By] FOREIGN KEY ([Rep_Created_By]) REFERENCES [app].[UserDetails] ([UserID])
    ALTER TABLE [app].[Representatives] ADD CONSTRAINT [FK_app.Representatives_app.UserDetails_Rep_Updated_By] FOREIGN KEY ([Rep_Updated_By]) REFERENCES [app].[UserDetails] ([UserID])
    ALTER TABLE [app].[LogInSession] ADD CONSTRAINT [FK_app.LogInSession_app.UserDetails_LoginUserId] FOREIGN KEY ([LoginUserId]) REFERENCES [app].[UserDetails] ([UserID]) ON DELETE CASCADE
    CREATE TABLE [app].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_app.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [app].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202306121239292_createNewEntity', N'Customer.Data.Application.Migrations.Configuration',  0x1F8B0800000000000400ED5DCD6EE4B811BE07C83B083A25C16CCB9EB96C8CEE5D78FC1334321E0FDCD62237836ED16D21FA5B89EDD808F26439E491F20A21F54B911445526AA9BD19F8624B6455B1F855515564D1FFFDF77F963FBF8681F502D3CC8FA3957DBA38B12D186D63CF8F762B7B8F9E7EF8D1FEF9A7DFFF6E79E585AFD62F55BB4FA41DEE19652BFB19A1E4CC71B2ED330C41B608FD6D1A67F1135A6CE3D0015EEC7C3C39F9B3737AEA404CC2C6B42C6B79B78F901FC2FC0FFCE7451C6D6182F620B8893D1864E573FC669353B5BE82106609D8C2957DB1CF501CC274710910589C2749E06F01C252D9D679E0032CD006064FB605A22846F98B3337831B94C6D16E93E00720B87F4B206EF704820C96C3386B9AAB8EE8E4231991D374AC486D730935099E7E2A55E4B0DD8D146DD72AC44ABCC2CA466F64D4B92257F6254C408A421821DB62D99D5D0429692AD1F4A2E9FFC1EA6CF5A1860B4615F9216D03B44FE12A827B9482E083F56DFF889BFF15BEDDC77F87D12ADA07012D39961DBF6B3DC08FBEA5710253F476079FB8F13CAC2F6DCB699370581A350571F762F4EB087DFA685B5FB148E03180355C284D6D509CC2BFC008A60041EF1B4008A678B6D71ECC15CE09D2CD963CA81863A862E3B3AD1BF0FA05463BF4BCB2F1AFB675EDBF42AF7A520AE3463EB655DC09A57BD8C76F9D9D6F91FF5233FA1CC7010491608CCA725FA4900CFDE1F31BA336650A6EE20DA470797B5575C51084F77EA83382CB5BB7B7F757F0E2EFF22967E860C7925E4204FC202B354186710783BC71F6EC2785375AD00316F6B94EE3F02E0E18DD089A3E6CE27DBA257318ABB5BF07E90E22A3319573A33526AA4FDF98EAA68A636ADA8BC6B4741A3727757E144533EF4711380EF7470432F17B55BFA91C1EE13789A7238C1EAE423C43D3B0FA06B2EC1F71EA4DC3CDD0E98EE5FE73190C9C6EDECFD0DD973CFB5DB5A81FE972F099B98309FFF1A0EA7371E71466D8880099A04CE86E29AFF3C0B56F5CADA419E766656D072C1BF2A59066DAB716F6B5958E68DAD5B083B37039EC6BAB3AAC9116440E4D268B2243E43816C6CA28751746A1311F706124FCB0B7F9750F15D8F6937A57D10411D87045CBD566B6A090AE066B58D16D9C8821672FF024AC2766BB347E44DE92F3223DCD07B8C65C25BA43719587E2EA0DC51DE60EBFC43B3FDAC02CCB732F26BE90A6701C8E909668EDE93B44B6FF548E31E79B0F7D047FA6E99872DE7988D43B6039A1526FC4516C100813DE7BF41194DAA0D0F2E8097B285A35C6C6BDE4EC8B6FA16352E759166FFD5C24F12706EBD3DAA3BD8A3C4BCFC115C810781C8C136C513E31392CE7CAFE13A75A656695022866AD4C429BD1C96271CAF1C2F60853027C105CE0D9C216EE4788375E3FDAFA0908B4C462A868A409C834D63CD93797308111B155AD095111865DF679A16ADE8CAFEAD3E2D2A1F0370096AE192CDD2961E91E272CDD6382A5AB0B4BFA93721658CA42FD2E9828C5FD4A189181512563A00EFBF1D0A82097EAEC0F84A2C23C0C936462FC0953342AF090E76B4645A234D333B56354156C22D7A83A25AAE2CCBF68F766DA34212348BB1D0A9D7CC2EE48D0C909362F3AB9295146E7EC6B77DF4E6F176294B77D1BC0D0A738D4A1A9BA5F3C353215E59A08988AD3A1224DC77189234267BFEB54DEC03F0C3AE7F79B8A72CD8A4E23AFD97114671674F249AB2E984832580D30DA895C750C7627BFD45077CA2A7E791B5DC2002268912D137220F002645BE0F1893E074B31025A3B4730113E3BA747857F2BEF3A010E8B1C26EE8327338269294595B5A7F2F5A4097C151D99C4D296DB0259996C66B145586C20E28CEE066408A618424D2655E03F39A8B6C9B5B0C8116ABDEDA1C405EC1C35AE450FC5B61172E4DAAF195AD484758AC86D8F519DD436D4588469A79FEB210BF4C7E1573BDF4C5197CDA4D356D65045BADA8A744D15E91E5491EEE115293D99C36B5139BBA79DDF531BA176424F7D5A062A4F7C1C48AEC1FE20CB2C43355097D2D06A12248A0F21292BB32326304BA88CA74C3E123898327BCF6CF3BAD40AFE8DC27F6AB4828F08893E55C3FE89D52985A656B46A14AF8EACCE09D129D8E0E715D81350298654D418649F6B8A31D4608D54A70EEA2FF6FADDD229CAC5CA074BA7A3AE6C790392C48F76549D59F9C4DA9445663F6CF4CBAEC28286B36DADE36C7C517342710A7690798B596349AFFD3443E4B8D02320A7412EBC906FD61D9F747C90578CBB42107E32AB6FF5AA27F9BD1D1DC94AC304C15E49E81A0F9CB4C875008536C877B648312008402A2FDEBA88837D1829948529D22CCE5276502D5EAAD36DCE4CD2049BA74612D249C50E39657947251E746AA883872C7BA4C4238FDE3A88E7EF0CA9BA12AAAE88EAD26170CAE52038D3E0B2386D9B53B248DA1B8E638B128A0AC628EDDDA5F92A79446BBC2BA124A7C21B5EF3548F525509C4D2AA9E6B526B8A7D3882CD2B4D9A5D36DCBBE3DA4D773C5F930BC15967F3549352972FE9DDBFEB95D0154A28B47129A5A2608823553C56A7559DE1A009759DEB98CDEBF467204C3C4F0F5505EFD34B611CADCBA85015192C31EA951E4DDEAB354FE7B06DF618262B9999EF614FD171EA33B2F2BA668325A7E985EA220E9ECE317D0FB462AD71CC524652C126E5DDBBD4CDD60ED05A97D725F4522D2B03388AE5734D6AD59E1347AE6B33AA9B1E7FE49F26CABF9D18745C08CD36A9B9D7A13413322FCBF055E1BE16369E2D9AD81656D98BEF915876F38623D0B080EBE6D7E022F0F35DAFAAC10D88FC2798A1A204C6C6E1F68FCC5D2FC773EF8A93655E2008FFC597AFB4676CB6AB4E7CA2EDDE4A1DF35B428AE5ADE015BD8074FB0CD23F84E0F58F3451939AC3471F8D7B7B892FBC11671D79F07565FF33A77066ADFFF62024F2C1BA4D315CCFAC13EB5FBA2393DE88622055436424A9A86249421931754BDAD45C3D6A46B77B1898973856D5BD4AE32006D584BF2358121DFF8E458EBD05633845730365BA0F3182319C4E132C0F33212E4636D0CA38AEA109AE4718117D43C720D4B40BF755D552F452D786F1CD0A060E699C2B0C0EE29084B716E49C06DE5930FB3782F84E021D388DE37AC4171CE8C8318EB133B72598DA3A737BC2C82B7F77743A678DFC412C8F2F8BEF3419D352775590515DBB1036A8485E041201C18397A2B7F6AA079C3EEF3CB636AC5E786831D04C95BABFF952F1EFB0991536B39734281FF61C67867BB06380C69130633A81E3D517FE7F945D8FE464A89E45867552B0CCE060D801ABB29D7F61D23BBFFB1D3547819AD9D725D332E5F14143D73919968FBE17B848CF46FE360B87BFE36516BCCCEE5FD44B790D10326A81ADF8CCFA8042E2F782AE9EC320475B98CB9D8F67E7B3ABD6B6A7C8B63897B0B24142924F45A6893D253F6629AE889FAC2282656550AB2B6279D0825E1143DC627DB425BF82F9D32A5BEB989403154F4E58C2FBBE14234BBB8C56923B60484355FBAE0A6D87D67F16B1E4D48A99A068F6C815336901EC50B5F0CB3C5B51F6CE4A58DF8342462F421D3A68D1C7496FE1EA38B5A6FC8158FCE94BFD9B43FCFD9DF9BB8604F9A78711DCB63E7AEB36EBE829AE3EC01989AA26CCFEE90DD60E0615384F91FF04B608BFDE92E192BBD27F01C11E37B90A1FA1B78E6EF728D9233C64183E06ADF8907CC3CBF8E705B56D9997B7497EF3F81843C062FAC42E6EA3CF7B3FF06AB9AF05DBBD1D24487050EEB393B94464BF7DF75653FA1A478A844AF5D531CD3D0C930013CB6EA30D20874BF465C318FE027760FB569D6BEE26D23F116DB52F2F7DB04B419895349AFEF84F8C612F7CFDE97F903A689BED730000 , N'6.4.4')
END

